---
sidebar_position: 8
---

# Configura√ß√µes de pol√≠tica de senhas fortes üîë

1. O primeiro passo √© a edi√ß√£o do ficheiro login.defs.

2. Uma vez que estamos a editar o ficheiro, modificaremos os seguintes par√¢metros:
- PASS_MAX_DAYS 99999 -> PASS_MAX_DAYS 30
- PASS_MIN_DAYS 0 -> PASS_MIN_DAYS 2

![password](./img/passcfg.png)

```bash
PASS_MAX_DAYS: # Este √© o tempo de expira√ß√£o da palavra-passe. O n√∫mero corresponde a dias.

PASS_MIN_DAYS: # O n√∫mero m√≠nimo de dias permitido antes de alterar uma palavra-passe.

PASS_WARN_AGE: # O utilizador receber√° uma mensagem de aviso indicando que o n√∫mero de dias especificado permanece at√© a sua senha expirar.
```

3.  Para continuar com a configura√ß√£o temos de instalar os seguintes pacotes com este comando `sudo apt install libpam-pwquality`, depois colocar Y para confirmar a instala√ß√£o e esperar que termine.
```bash
# A libpam-pwquality √© uma biblioteca que faz parte do PAM (Pluggable Authentication Modules), um sistema usado para gerenciar autentica√ß√£o no Linux. 
# Essa biblioteca √© usada para for√ßar requisitos de complexidade de senha. Com ela instalada e configurada, voc√™ pode definir pol√≠ticas de senha que ajudem a garantir que as senhas dos usu√°rios sejam fortes e dif√≠ceis de adivinhar.
```

![password](./img/libpam.png)

4. A pr√≥xima coisa a fazer √© voltar atr√°s e editar um ficheiro e modificar algumas linhas. Faremos `nano /etc/pam.d/common-password`
Na linha de password requisite apos retry=3 colocaremos os seguintes comandos:
```bash
minlen=10 # O n√∫mero m√≠nimo de caracteres que a senha deve conter.
ucredit=-1 # Deve conter pelo menos uma letra mai√∫scula. Colocamos o - como deve conter pelo menos um caracter, se colocarmos + queremos dizer no m√°ximo esses caracteres.
dcredit=-1 # Deve conter pelo menos um d√≠gito.
lcredit=-1 # Deve conter pelo menos uma letra min√∫scula.
maxrepeat=3 # N√£o se pode ter o mesmo car√°cter mais de 3 vezes seguidas.
reject_username # N√£o pode conter o nome do utilizador.
difok=7 # Deve ter pelo menos 7 caracteres que n√£o fa√ßam parte da senha antiga.
enforce_for_root #  Iremos implementar esta pol√≠tica para o utilizador de raiz.
```
![password](./img/pamcf.png)

:::danger[danger]
A pol√≠tica de palavras-passe recentemente implementada afecta apenas os novos utilizadores. Portanto, √© necess√°rio atualizar as contas de utilizador que foram criadas antes desta pol√≠tica para cumprir os novos requisitos de seguran√ßa. Para verificar se o utilizador n√£o est√° em conformidade com a pol√≠tica, vamos utilizar o comando sudo `chage -l username`.
:::

![password](./img/pamcheck.png)

5. Se verificarmos que este utilizador n√£o cumpre a pol√≠tica devemos modificar o n√∫mero m√≠nimo e m√°ximo de dias entre altera√ß√µes de password, para isso vamos utilizar o seguinte comando: `sudo chage -m <time> <username> e sudo chage -M <time> <username>`.

```bash
# sudo chage -m 2 malopes-
# sudo chage -M 30 malopes-
# -m √© para o n√∫mero m√≠nimo de dias e -M para o n√∫mero m√°ximo de dias.
```

![password](./img/checkpam2.png)
