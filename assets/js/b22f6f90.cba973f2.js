"use strict";(self.webpackChunkwiki_42_mwx=self.webpackChunkwiki_42_mwx||[]).push([[2280],{7880:(a,e,t)=>{t.r(e),t.d(e,{assets:()=>s,contentTitle:()=>o,default:()=>l,frontMatter:()=>r,metadata:()=>d,toc:()=>c});var n=t(4848),i=t(8453);const r={sidebar_position:3},o="fdf.c Inicio de Tudo",d={id:"rank 02/FdF/guia_fdf_pronta/FdF2",title:"fdf.c Inicio de Tudo",description:'Este arquivo "MAIN" inicia o FDF e organiza a execu\xe7\xe3o do programa, desde a valida\xe7\xe3o de par\xe2metros at\xe9 a libera\xe7\xe3o de recursos. Abaixo est\xe1 a fun\xe7\xe3o principal e suas responsabilidades',source:"@site/docs/rank 02/FdF/guia_fdf_pronta/FdF2.mdx",sourceDirName:"rank 02/FdF/guia_fdf_pronta",slug:"/rank 02/FdF/guia_fdf_pronta/FdF2",permalink:"/wiki_ft/docs/rank 02/FdF/guia_fdf_pronta/FdF2",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/rank 02/FdF/guia_fdf_pronta/FdF2.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"FdF.h A Organiza\xe7\xe3o",permalink:"/wiki_ft/docs/rank 02/FdF/guia_fdf_pronta/Header"},next:{title:"SRC files",permalink:"/wiki_ft/docs/category/src-files"}},s={},c=[{value:"fdf",id:"fdf",level:3},{value:"Malloc_structs",id:"malloc_structs",level:3},{value:"Start_server",id:"start_server",level:3},{value:"Set_variables",id:"set_variables",level:3},{value:"Make_img",id:"make_img",level:3}];function _(a){const e={admonition:"admonition",code:"code",h1:"h1",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...a.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.header,{children:(0,n.jsx)(e.h1,{id:"fdfc-inicio-de-tudo",children:"fdf.c Inicio de Tudo"})}),"\n",(0,n.jsxs)(e.p,{children:["Este arquivo ",(0,n.jsx)(e.strong,{children:'"MAIN"'})," inicia o FDF e organiza a execu\xe7\xe3o do programa, desde a valida\xe7\xe3o de par\xe2metros at\xe9 a libera\xe7\xe3o de recursos. Abaixo est\xe1 a fun\xe7\xe3o principal e suas responsabilidades"]}),"\n",(0,n.jsx)(e.h3,{id:"fdf",children:"fdf"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-C",metastring:"fdf.c",children:"int\tmain(int argc, char **argv)\n{\n\tt_fdf_gen\tgen_data; //Inicializa\xe7\xe3o da Struct Mae\n\n    // Verifica se h\xe1 quantidade necess\xe1ria de par\xe2metros\n\tif (argc != 2)\n\t{\n\t\tft_putstr(NF_MAP);\n\t\treturn (0);\n\t}\n\t// Verifica se mallocou corretamente\n\n\tif (!malloc_structs(&gen_data))\n\t\treturn (0);\n    // Verifica se efeturou corretamente a leitura do mapa caso n\xe3o\n    // Libera os itens acima ja mallocados\n\tif (!read_file(argv[1], gen_data.data))\n\t{\n\t\tfree_resources(&gen_data);\n\t\treturn (0);\n\t}\n\t// verifica se inicializou corretamente o server para iniciar o loop\n\t// hooks e imagens\n\tif (start_server(&gen_data))\n\t{\n\t\tmake_img(&gen_data);\n\t\tpack_hooks(&gen_data);\n\t\tmlx_loop(gen_data.data->mlx_ptr);\n\t}\n\t// libera todos os ponteiros e recursos ao final da aplica\xe7\xe3o\n\tfree_pointer_server(&gen_data);\n\tfree_resources(&gen_data);\n\t\n}\n"})}),"\n",(0,n.jsx)(e.h3,{id:"malloc_structs",children:"Malloc_structs"}),"\n",(0,n.jsx)(e.p,{children:"De forma legivel foi implementada essa fun\xe7\xe3o statica que inicializa toda as structs e verifica corretamente\nse est\xe3o inicializadas."}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-c",metastring:"malloc_structs",children:"static int\tmalloc_structs(t_fdf_gen *gen_data)\n{\n\tgen_data->data = (t_fdf *)malloc(sizeof(t_fdf));\n\tif (!gen_data->data)\n\t{\n\t\tfree_resources(gen_data);\n\t\treturn (0);\n\t}\n\tgen_data->graph = (t_graph *)malloc(sizeof(t_graph));\n\tif (!gen_data->graph)\n\t{\n\t\tfree_resources(gen_data);\n\t\treturn (0);\n\t}\n\tgen_data->img_data = (t_img *)malloc(sizeof(t_img));\n\tif (!gen_data->img_data)\n\t{\n\t\tfree_resources(gen_data);\n\t\treturn (0);\n\t}\n\treturn (1);\n}\n"})}),"\n",(0,n.jsx)(e.h3,{id:"start_server",children:"Start_server"}),"\n",(0,n.jsx)(e.p,{children:"Funcao que vai iniciarlizar a biblioteca e definir alguns ponteiros de contexto grafico"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-c",metastring:"start_server",children:'static int\tstart_server(t_fdf_gen *gen_data)\n{\n    // Inicializa a biblioteca Minilibx e armazena o ponteiro para o contexto gr\xe1fico.\n\tgen_data->data->mlx_ptr = mlx_init();\n\tif (!gen_data->data->mlx_ptr)\n\t\treturn (0);\n    // Define a largura e altura dinamicamente de acordo com a janela\n\tgen_data->data->win_width = 1920;\n\tgen_data->data->win_height = 1080;\n\tgen_data->data->win_ptr = NULL;\n   // mlx_get_screen_size(gen_data->data->mlx_ptr, &gen_data->data->win_width, &gen_data->data->win_height);\n\t// Verifica se a largura ou altura da janela calculada s\xe3o inv\xe1lidas (valores negativos).\n    if (gen_data->data->win_width < 0 || gen_data->data->win_height < 0)\n\t\treturn (0);\n    // Cria uma nova janela na MiniLibX com as dimens\xf5es especificadas e o t\xedtulo "FdF".\n\tgen_data->data->win_ptr = mlx_new_window(\n\t\t\tgen_data->data->mlx_ptr,\n\t\t\tgen_data->data->win_width,\n\t\t\tgen_data->data->win_height,\n\t\t\t"FdF"\n\t\t\t);\n\tif (!gen_data->data->win_ptr)\n\t\treturn (0);\n    // Inicializa vari\xe1veis adicionais necess\xe1rias para o programa.\n\tset_variables(gen_data);\n\treturn (1);\n}\n'})}),"\n",(0,n.jsx)(e.h3,{id:"set_variables",children:"Set_variables"}),"\n",(0,n.jsx)(e.p,{children:"Funcao que vai inializar algumas variaveis para definir algumas regras para mostrar a imagem"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-c",metastring:"Set_variables",children:"static void\tset_variables(t_fdf_gen *gen_data)\n{\n    // Vari\xe1veis locais para armazenar as coordenadas do centro do mapa.\n\tfloat\tmap_center_x;\n\tfloat\tmap_center_y;\n\n\tmap_center_x = 0;\n\tmap_center_y = 0;\n    // Define o zoom padr\xe3o.\n\tgen_data->graph->zoom = 3;\n    // Define os \xe2ngulos de rota\xe7\xe3o para o gr\xe1fico.\n\tgen_data->graph->angle_x = 0.2;\n\tgen_data->graph->angle_y = 0.2;\n    // Define o fator de profundidade\n\tgen_data->graph->depth_factor = 0.4;\n    // Calcula o centro do mapa em rela\xe7\xe3o ao zoom aplicado e ao n\xfamero de pontos no eixo X.\n\tmap_center_x = (gen_data->data->width - 1) * gen_data->graph->zoom / 50.0;\n\tmap_center_y = (gen_data->data->height - 1) * gen_data->graph->zoom / 50.0;\n    // Define o deslocamento do gr\xe1fico no eixo X e Y, de modo que o centro do mapa\n\t// seja posicionado no meio da janela de exibi\xe7\xe3o.\n\tgen_data->graph->shift_x = (gen_data->data->win_width / 2) - map_center_x;\n\tgen_data->graph->shift_y = (gen_data->data->win_height / 2) - map_center_y;\n}\n"})}),"\n",(0,n.jsx)(e.admonition,{title:"calculo do centro do mapa",type:"warning",children:(0,n.jsx)(e.p,{children:'Se n\xe3o calcular o centro corretamente ap\xf3s aplicar o zoom, o mapa ficaria levemente n\xe3o centralizado, porque o centro "real" do mapa (ap\xf3s o zoom) mudaria, mas o c\xe1lculo de centraliza\xe7\xe3o n\xe3o seria atualizado. Isso pode causar o mapa a parecer deslocado na tela.'})}),"\n",(0,n.jsx)(e.admonition,{title:"calculo do centro da tela",type:"warning",children:(0,n.jsx)(e.p,{children:"Agora que temos o centro do mapa precisamos calcular onde posicionar esse centro em relacao a janela"})}),"\n",(0,n.jsx)(e.h3,{id:"make_img",children:"Make_img"}),"\n",(0,n.jsx)(e.p,{children:"Funcao que vai criar uma nova imagem, Recupera o endere\xe7o dos dados da imagem e Desenhar a imagem no contexto gr\xe1fico"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-c",metastring:"Make_img",children:"static void\tmake_img(t_fdf_gen *gen_data)\n{\n\tgen_data->img_data->img_ptr = mlx_new_image(\n\t\t\tgen_data->data->mlx_ptr,\n\t\t\tgen_data->data->win_width,\n\t\t\tgen_data->data->win_height\n\t\t\t);\n\tgen_data->img_data->img_data = mlx_get_data_addr(\n// Ponteiro da imagem\n\t\t\tgen_data->img_data->img_ptr,\n// Armazenar\xe1 o n\xfamero de bits usados para representar cada pixel na imagem. 8x4 = 32\n\t\t\t&gen_data->img_data->bpp,\n// Tamanho de cada linha da imagem, em bytes\n\t\t\t&gen_data->img_data->size_line,\n// Ordem dos bytes na mem\xf3ria\n\t\t\t&gen_data->img_data->endian\n\t\t\t);\n// Funcao que desenha na tela\n\tdraw(gen_data);\n}\n"})})]})}function l(a={}){const{wrapper:e}={...(0,i.R)(),...a.components};return e?(0,n.jsx)(e,{...a,children:(0,n.jsx)(_,{...a})}):_(a)}},8453:(a,e,t)=>{t.d(e,{R:()=>o,x:()=>d});var n=t(6540);const i={},r=n.createContext(i);function o(a){const e=n.useContext(r);return n.useMemo((function(){return"function"==typeof a?a(e):{...e,...a}}),[e,a])}function d(a){let e;return e=a.disableParentContext?"function"==typeof a.components?a.components(i):a.components||i:o(a.components),n.createElement(r.Provider,{value:e},a.children)}}}]);